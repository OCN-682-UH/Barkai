---
title: "Week 9 Homework - Mean Algae Plot"
author: "Leah Barkai"
date: today
format: 
  html:
    theme: cosmo
    self-contained: true
    toc: true
    toc-depth: 2
editor: visual
knitr: #this is to save figures automatically 
  opts_chunk:
    fig.path: "../Output/" ## added the ../ because my qmd folder is in my scripts folder so need to go up one directory and then into my output folder
    message: false #gets rid of messages from code
    warning: false #gets rid of warnings from code
---

## Introduction

This document is for my homework for week 9. I decided to focus on the algae data with the latitude coordinates too.

## Load Libraries

These are the libraries I needed for this homework assignment.

```{r}
library(tidyverse) #loads a bunch of data-science packages
library(here) #to save my plot
library(forcats) #use when working with factors
```

## Read in data

This data was provided to me by Nyssa Silbiger.

```{r}
Data<-read.csv(here("Week_09", "Data", "intertidaldata.csv"))
Data_Dictionary<-read.csv(here("Week_09", "Data", "intertidal_data_dictionary.csv")) #If you read in your data as read.csv() then all your strings will be automatically read in as factors, if you use read_csv() strings will be read as characters.
Latitude_Data<-read.csv(here("Week_09", "Data", "intertidaldata_latitude.csv"))
```

## Data Dictionary

```{r}
#| echo: false
head(Data_Dictionary)
```

## Look at the data

This was to get an idea of what was in the data.

```{r}
#| echo: false
view(Data) #look at the data
glimpse(Latitude_Data) #overview of data
```

## Clean up the Data

```{r}
#Merging latitude data with intertidal data 
algae_data <- Data %>% #Using my dataset called Data and making a new name
  left_join(Latitude_Data, by = "Site") %>% #Use left_join to keep all rows from Data then add laititude data 
  mutate(Site = fct_reorder(Site, Latitude)) # Reorder the latitude to south → north

#Making a summary table of mean algae cover per site
mean_summary <- algae_data %>% #Taking the algae data making new dataset with the means
  group_by(Site) %>% #Groups the data by site to make a summary of it
  summarize(mean_cover = mean(Algae, na.rm = TRUE)) #Finds the mean algae cover per site and ignores the NA values 
```

## Plot

```{r mean-algae-plot}
#Making plot 
mean_plot <- mean_summary %>% #Name for plot
  ggplot(aes(x = Site, y = mean_cover)) + #X and y axis
  geom_col(fill = "seagreen3") + #color of bars
  geom_text(aes(label = round(mean_cover, 1), #Rounds the cover to one decimal place
                color = ifelse(mean_cover == min(mean_cover), "low", #finding the lowest number
                               ifelse(mean_cover == max(mean_cover), "high", "normal"))), #finding the highest number
            vjust = -0.5) + #moving the text up above the bars
  scale_color_manual(values = c(low = "red", high = "purple", normal = "black")) + #setting the text colors to highlight low and high
  labs(
    title = "Mean Algae Cover by Site",
    subtitle = "Sites ordered from south to north",
    x = "Site (south → north)",
    y = "Mean Algae Cover"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), #Rotating the labels to be able to read
        legend.position = "none")  #Hiding the legend

print(mean_plot)
```

[Summary of data:]{.underline}

The bar plot shows the mean algae cover at each site. From the plot, you can see that Pyramid Point had the lowest mean algae cover at 6.5% (highlighted in red), while Point St. George had the highest mean cover at 61.1% (highlighted in purple).
